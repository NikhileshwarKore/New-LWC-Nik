LWR.define("@salesforce/label/MyCommunities.errorInFileDownload/v/0_7_4",["exports"],function(e){"use strict";var o="MyCommunities.errorInFileDownload";e.default=o,Object.defineProperty(e,"__esModule",{value:!0})});LWR.define("mobileruntime/hybridAppManager/v/1",["exports","lwr/loaderLegacy/v/0_7_4","logger/v/1_66_127-240_0","@app/basePath/v/1","@app/loginPath/v/1","webruntime/routingService/v/1_66_127-240_0","@salesforce/label/MyCommunities.errorInFileDownload/v/0_7_4","webruntime/overrides/v/1_66_127-240_0"],function(R,l,a,O,T,I,S,c){"use strict";function u(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var d=u(O),f=u(T),N=u(S);function h(e,t){if(!L()){a.log("Native JS API is not available");return}const{invokeNative:n}=window.mycommunities.nativejsapi;return n(e,t)}function C(e=""){return new RegExp("^([a-z]+://)","i").test(e)}function k(e=""){if(!C(e))return!1;const t=new URL(e),n=window.location.host;return t.host!==n}function b(){if(!L()){a.log("Native JS API is not available");return}G();const{webAppBootstrapDone:e}=window.mycommunities.nativejsapi;a.log("Triggering webAppBootstrapDone"),e(!0),a.log("Initial load done! Splash Screen hidden")}function M(e,t){const n=new URL(e||"",window.location.origin);e=n.href;const o="/servlet/networks/switch",i=n.pathname,r=i.indexOf("/s/"),s=r===-1?i:i.substring(0,r+2);return[o,encodeURIComponent(o)].some(v=>e.includes(v))||!s.startsWith(t)}function F(e){if(!e)return null;switch(e.length){case 15:return W(e);case 18:return e;default:return null}}function j(){const{cordova:e}=window;return typeof e!="undefined"&&e&&e.require("cordova/channel")&&e.require("cordova/channel").onDeviceReady&&e.require("cordova/channel").onDeviceReady.state===2}function w(){return j()?window.cordova.require("com.salesforce.plugin.oauth"):null}function x(e){if(!e)return!1;const t="/secur/logout.jsp";return e.includes(t)||e.includes(encodeURIComponent(t))}function H(e){const t=w();t&&t.logout(e)}function W(e){let t="";const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456";for(let o=0;o<3;++o){let i=0;for(let r=0;r<5;r++){const s=e.charAt(o*5+r);s>="A"&&s<="Z"&&(i+=1<<r)}t+=n.charAt(i)}return e+t}function L(){return window.mycommunities&&window.mycommunities.nativejsapi}function G(){if(window.navigator?.userAgent?.includes("android")){const{head:e}=document,t=document.createElement("script");t.src="/localhost/cordova.js",e.appendChild(t)}}const J="/secur/frontdoor.jsp";function q({routeUrl:e}){const t=w();t?t.authenticate(function(n){n&&n.csrfToken&&n.accessToken&&(document.cookie=`sid=${n.accessToken}; path=/; secure=true`,window.localStorage.setItem("sid",n.csrfToken),e!=null&&window.open(e))},function(){a.logError("Error in handler Session Timeout. Cordova OAuth Plugin authentication failed.")}):a.logError("Error in handler Session Timeout. OAuth Plugin is not available.")}async function B(){let e=!1;const t=await l.load("@app/user/v/1");try{await l.load(`@app/user?c=${crypto.randomUUID()}`,"mobileruntime/hybridAppManager/v/1")}catch(n){e=!t.isGuest}return e}function P(e){const t=new URL(f.default,window.location.href),n=new URL(e,window.location.href);return f.default&&t.pathname===n.pathname&&t.origin===n.origin}function U(e){const t=w();t?t.authenticate(function(n){window.location.href=`${n.loginUrl}${J}?sid=${n.accessToken}&retURL=${encodeURIComponent(e||d.default)}&display=touch`},function(){throw new Error("Authentication via Cordova OAuth Plugin failed.")}):window.location.href=e||f.default}function V(e){if(typeof e=="object"){const{attributes:{url:t}={url:null}}=e;if(P(t)){const n=new URL(t,window.location.href);return U(n.searchParams.get("startURL")),!1}}return!0}async function X({next:{route:e,data:t}={}}={}){if(t&&t.isPublic!==!1)return!0;const{default:n}=await l.load("@app/user/v/1");if(n.isGuest){const o=await I.generateUrl(e);if(o){const i=new URL(o,window.location.href);return U(i.pathname+i.search+i.hash),!1}}return!0}const Z=["/sfc/servlet.shepherd","/servlet/servlet.FileDownload","/servlet/fileField","version/renditionDownload"];function g(){a.log("Handle showing of Toast Message for Error case.")}function $(e){const t="/sfc/servlet.:type/:contentType/download/:recordId",n=new RegExp(t.replace(/:[^\s/]+/g,"([\\w-]+)")),o=e.match(n);if(o&&o.length===4)return{recordId:o[3]};const i="/servlet/servlet.:type?file=:recordId",r=new RegExp(i.replace(/:[^\s/?]+/g,"([\\w-]+)").replace(/\?/g,"[?]")),s=e.match(r);if(s&&s.length===3)return{recordId:s[2]};const v="/servlet/fileField";if(e.includes(v)){const p=new URLSearchParams(decodeURIComponent(e).split("?")[1]),m=p.get("entityId"),re=p.get("field");return{recordId:m,fieldId:re}}const ae="version/renditionDownload";if(e.includes(ae)){const m=new URL(e).searchParams.get("versionId");return{recordId:F(m)}}return null}function z(e){const t=h("downloadFile",e);if(t)return t.catch(n=>{a.log(`Error while downloading file of record id: ${e.recordId} message: ${n}`&&n.message),g()})}function K(e){if(!e){a.log(`${N.default}. URL is ${e}`),g();return}const t=$(e);if(!t){a.log(`Parsing the file URL "${e}" yielded null`),g();return}return z(t)}function Q(e){return e=e||"",Z.some(t=>e.indexOf(t)>-1)}function y(e){const t=new URL(e,window.location.href);if(e=t.href,x(e))H(e);else if(k(t))h("navigateToExternalURL",{url:e});else if(P(e))E({type:"standard__webPage",attributes:{url:t.pathname+t.searchParams+t.hash}},!1);else if(Q(e))K(e);else if(M(e,d.default))h("navigateToExternalURL",{url:e});else{const n=t.pathname,o=n==="/"||n===d.default;E(n,o)}}function E(e,t){return document.dispatchEvent(new CustomEvent("notify-client-module",{cancelable:!0,composed:!0,detail:{action:"navigate",data:{routeObj:e,replaceState:t}}}))}function Y(){_()}function _(){document.addEventListener("click",te),document.addEventListener("notify-mobile-module",ne)}function ee({route:e,routeInfoData:t}){const{type:n,id:o}=e||{},{isRoot:i,path:r}=t||{};document.dispatchEvent(new CustomEvent("routeChangeSuccess",{bubbles:!0,composed:!0,detail:{routeType:n,routeId:o,routeUrl:r,backNavigation:{canGoBack:!i}}}))}function te(e){const t=e.composedPath()[0];if(t.tagName.toLowerCase()==="a")return e.preventDefault(),e.stopPropagation(),y(t.href)}function ne({detail:e}){const{action:t,data:n}=e||{action:"",data:null};switch(t){case"navigationcompleted":ee(n||{});break;default:a.log(`No such ${t} exists in notify-mobile-module event. Please re-check!!`);break}}function oe(){window.open=e=>y(e)}function A(){return/interactive|complete/.test(document.readyState)?b():document.addEventListener("DOMContentLoaded",b,!1),oe(),Y()}function D(){return q({routeUrl:window.location.pathname}),!1}c.PreNavigateOverrides.add(e=>X(e)),c.NavigationOverrides.add(e=>V(e)),c.PageNavigationFailureOverrides.add(async({error:e,isPublic:t})=>{const n=await B();return e?.constructor?.name==="LoaderError"&&!t&&n?D():!0}),c.SessionTimeoutOverrides.add(()=>D());function ie(e){Object.entries(e).forEach(([t,n])=>{LWR.define(t,[],function(){return n})})}ie({"mobileruntime/hybridAppManager":A}),R.hybridAppManager=A,Object.defineProperty(R,"__esModule",{value:!0})});